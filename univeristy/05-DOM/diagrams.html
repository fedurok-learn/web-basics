<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />

    <!-- jQuery library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="row my-4">
            <h3>Середній бал студентів групи КП-72</h3>
        </div>
        <div class="row">
            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">Ім'я</th>
                        <th scope="col">Середній бал</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <tr id="student1">
                        <td><button type="button" class="btn btn-link" onclick="removeStudent(1)">Видалити</button></td>
                        <td>
                            <p contenteditable="true" id="student-name-1">Mark</p>
                        </td>
                        <td>
                            <p contenteditable="true" id="student-mark-1">75</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="row my-4">
            <div class="col text-center">
                <button class="btn btn-primary" onclick="addStudent()">Додати студента</button>
            </div>
        </div>
        <div class="row text-center my-4">
            <div class="col">
                <h1>Діаграма</h1>
            </div>
        </div>
        <div class="row text-center align-items-end" style="height: 500px;" id="diagram-container">
            <div class="col" id="diagram1" style="height: 75%; background-color:yellow;">
                <h3 class="mt-3">Mark</h3>
            </div>
        </div>
    </div>

    <script>
        'use strict';

        const tBody = document.getElementById('table-body');
        const diagramContainer = document.getElementById('diagram-container');
        var stNum = 1;

        const setFieldActions = (studentNum) => {
            const isLatin = (val) => /^[a-zA-Z]+$/.test(val);

            document.getElementById(`student-name-${studentNum}`).onkeypress = (e) => { 
                if (e.keyCode == 13) changeDiagramName(studentNum, e.value)
                if (!isLatin(String.fromCharCode(e.which))) e.preventDefault(); 
            };
            document.getElementById(`student-mark-${studentNum}`).onkeypress = (e) => { 
                if (e.keyCode == 13) changeDiagramValue(studentNum, e.value)
                if (isNaN(String.fromCharCode(e.which))) e.preventDefault(); 
            };
        }
        setFieldLimitations(stNum);

        const addStudent = (name="Name", mark=0) => {
            stNum++;

            // append new student to the list
            const tr = document.createElement('tr');
            tr.id = `student${stNum}`;
            tr.innerHTML = `
                <td><button type="button" class="btn btn-link" onclick="removeStudent(${stNum})">Видалити</button></td>
                <td><p contenteditable="true" id="student-name-${stNum}">${name}</p></td>
                <td><p contenteditable="true" id="student-mark-${stNum}">${mark}</p></td>
            `;
            tBody.appendChild(tr);
            
            // disable false characters from typing
            setFieldActions(stNum);
            
        }

        const removeStudent = (num) => {
            const student = document.getElementById(`student${num}`);
            student.parentNode.removeChild(student);
        }

        const addDiagram = (name, mark) => {
            const diagram = document.createElement('diagram');
            diagram.id = `student${stNum}`;
            diagram.innerHTML = `
                <td><button type="button" class="btn btn-link" onclick="removeStudent(${stNum})">Видалити</button></td>
                <td><p contenteditable="true" id="student-name-${stNum}">${name}</p></td>
                <td><p contenteditable="true" id="student-mark-${stNum}">${mark}</p></td>
            `;
            diagramContainer.appendChild(diagram);
            <div class="col" id="diagram1" style="height: 75%; background-color:yellow;">
                <h3 class="mt-3">Mark</h3>
            </div>
        }

        const changeDiagramName = (num, val) => {
            
        }
        
        const changeDiagramValue = (num, val) => {

        }
    </script>
</body>


</html>